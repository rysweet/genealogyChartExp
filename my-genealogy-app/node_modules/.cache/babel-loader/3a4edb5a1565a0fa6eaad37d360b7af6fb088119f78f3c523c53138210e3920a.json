{"ast":null,"code":"export async function importGedcomFile(file) {\n  const text = await file.text();\n  const peopleById = {};\n  const familiesById = {};\n  let currentRecord = null;\n  let currentType = null;\n  const lines = text.split(/\\\\r?\\\\n/);\n  function finishRecord() {\n    if (!currentRecord || !currentType) return;\n    if (currentType === \"INDI\") {\n      console.log(\"Parsed individual:\", currentRecord);\n      peopleById[currentRecord.id] = currentRecord;\n    } else if (currentType === \"FAM\") {\n      console.log(\"Parsed family:\", currentRecord);\n      familiesById[currentRecord.id] = currentRecord;\n    }\n    currentRecord = null;\n    currentType = null;\n  }\n  lines.forEach(line => {\n    const parts = line.trim().split(\" \");\n    if (parts.length < 2) return;\n    const level = parts[0];\n    const tagOrId = parts[1];\n    if (level === \"0\" && tagOrId.startsWith(\"@\") && parts.length >= 3) {\n      const recordType = parts[2];\n      finishRecord();\n      const cleanedId = tagOrId.replace(/^@|@$/g, \"\");\n      if (recordType === \"INDI\") {\n        currentRecord = {\n          id: cleanedId,\n          firstName: \"\",\n          lastName: \"\",\n          birthDate: \"\",\n          deathDate: \"\",\n          parents: []\n        };\n        currentType = \"INDI\";\n      } else if (recordType === \"FAM\") {\n        currentRecord = {\n          id: cleanedId,\n          husb: null,\n          wife: null,\n          children: []\n        };\n        currentType = \"FAM\";\n      }\n    } else if (currentType === \"INDI\") {\n      const rest = line.trim().substring(2).trim();\n      if (rest.startsWith(\"NAME\")) {\n        let nameVal = rest.replace(\"NAME\", \"\").trim();\n        const nameParts = nameVal.split(\"/\");\n        if (nameParts.length >= 2) {\n          currentRecord.firstName = nameParts[0].trim();\n          currentRecord.lastName = nameParts[1].trim();\n        } else {\n          currentRecord.firstName = nameVal;\n        }\n      } else if (rest.startsWith(\"GIVN\")) {\n        currentRecord.firstName = rest.replace(\"GIVN\", \"\").trim();\n      } else if (rest.startsWith(\"SURN\")) {\n        currentRecord.lastName = rest.replace(\"SURN\", \"\").trim();\n      } else if (rest.startsWith(\"BIRT\")) {} else if (rest.startsWith(\"DEAT\")) {} else if (rest.startsWith(\"DATE\")) {\n        if (line.includes(\"BIRT\")) {\n          currentRecord.birthDate = rest.replace(\"DATE\", \"\").trim();\n        } else if (line.includes(\"DEAT\")) {\n          currentRecord.deathDate = rest.replace(\"DATE\", \"\").trim();\n        } else {\n          if (!currentRecord.birthDate) {\n            currentRecord.birthDate = rest.replace(\"DATE\", \"\").trim();\n          } else {\n            currentRecord.deathDate = rest.replace(\"DATE\", \"\").trim();\n          }\n        }\n      }\n    } else if (currentType === \"FAM\") {\n      const rest = line.trim().substring(2).trim();\n      if (rest.startsWith(\"HUSB\") || rest.startsWith(\"WIFE\") || rest.startsWith(\"CHIL\")) {\n        const tokens = rest.split(\" \");\n        const refId = tokens[1] ? tokens[1].replace(/^@|@$/g, \"\") : null;\n        if (rest.startsWith(\"HUSB\")) currentRecord.husb = refId;else if (rest.startsWith(\"WIFE\")) currentRecord.wife = refId;else if (rest.startsWith(\"CHIL\")) currentRecord.children.push(refId);\n      }\n    }\n  });\n  finishRecord();\n  Object.values(familiesById).forEach(fam => {\n    const father = fam.husb;\n    const mother = fam.wife;\n    fam.children.forEach(childId => {\n      if (peopleById[childId]) {\n        peopleById[childId].parents = [];\n        if (father) peopleById[childId].parents.push(father);\n        if (mother) peopleById[childId].parents.push(mother);\n      }\n    });\n  });\n  return Object.values(peopleById);\n}","map":{"version":3,"names":["importGedcomFile","file","text","peopleById","familiesById","currentRecord","currentType","lines","split","finishRecord","console","log","id","forEach","line","parts","trim","length","level","tagOrId","startsWith","recordType","cleanedId","replace","firstName","lastName","birthDate","deathDate","parents","husb","wife","children","rest","substring","nameVal","nameParts","includes","tokens","refId","push","Object","values","fam","father","mother","childId"],"sources":["/Users/ryan/genealogyChartExp/my-genealogy-app/src/gedcom/importGedcom.js"],"sourcesContent":["export async function importGedcomFile(file) {\n  const text = await file.text();\n  const peopleById = {};\n  const familiesById = {};\n  let currentRecord = null;\n  let currentType = null;\n  const lines = text.split(/\\\\r?\\\\n/);\n\n  function finishRecord() {\n    if (!currentRecord || !currentType) return;\n    if (currentType === \"INDI\") {\n      console.log(\"Parsed individual:\", currentRecord);\n      peopleById[currentRecord.id] = currentRecord;\n    } else if (currentType === \"FAM\") {\n      console.log(\"Parsed family:\", currentRecord);\n      familiesById[currentRecord.id] = currentRecord;\n    }\n    currentRecord = null;\n    currentType = null;\n  }\n\n  lines.forEach((line) => {\n    const parts = line.trim().split(\" \");\n    if (parts.length < 2) return;\n    const level = parts[0];\n    const tagOrId = parts[1];\n\n    if (level === \"0\" && tagOrId.startsWith(\"@\") && parts.length >= 3) {\n      const recordType = parts[2];\n      finishRecord();\n      const cleanedId = tagOrId.replace(/^@|@$/g, \"\");\n      if (recordType === \"INDI\") {\n        currentRecord = { id: cleanedId, firstName: \"\", lastName: \"\", birthDate: \"\", deathDate: \"\", parents: [] };\n        currentType = \"INDI\";\n      } else if (recordType === \"FAM\") {\n        currentRecord = { id: cleanedId, husb: null, wife: null, children: [] };\n        currentType = \"FAM\";\n      }\n    } else if (currentType === \"INDI\") {\n      const rest = line.trim().substring(2).trim();\n      if (rest.startsWith(\"NAME\")) {\n        let nameVal = rest.replace(\"NAME\", \"\").trim();\n        const nameParts = nameVal.split(\"/\");\n        if (nameParts.length >= 2) {\n          currentRecord.firstName = nameParts[0].trim();\n          currentRecord.lastName = nameParts[1].trim();\n        } else {\n          currentRecord.firstName = nameVal;\n        }\n      } else if (rest.startsWith(\"GIVN\")) {\n        currentRecord.firstName = rest.replace(\"GIVN\", \"\").trim();\n      } else if (rest.startsWith(\"SURN\")) {\n        currentRecord.lastName = rest.replace(\"SURN\", \"\").trim();\n      } else if (rest.startsWith(\"BIRT\")) {\n      } else if (rest.startsWith(\"DEAT\")) {\n      } else if (rest.startsWith(\"DATE\")) {\n        if (line.includes(\"BIRT\")) {\n          currentRecord.birthDate = rest.replace(\"DATE\", \"\").trim();\n        } else if (line.includes(\"DEAT\")) {\n          currentRecord.deathDate = rest.replace(\"DATE\", \"\").trim();\n        } else {\n          if (!currentRecord.birthDate) {\n            currentRecord.birthDate = rest.replace(\"DATE\", \"\").trim();\n          } else {\n            currentRecord.deathDate = rest.replace(\"DATE\", \"\").trim();\n          }\n        }\n      }\n    } else if (currentType === \"FAM\") {\n      const rest = line.trim().substring(2).trim();\n      if (rest.startsWith(\"HUSB\") || rest.startsWith(\"WIFE\") || rest.startsWith(\"CHIL\")) {\n        const tokens = rest.split(\" \");\n        const refId = tokens[1] ? tokens[1].replace(/^@|@$/g, \"\") : null;\n        if (rest.startsWith(\"HUSB\")) currentRecord.husb = refId;\n        else if (rest.startsWith(\"WIFE\")) currentRecord.wife = refId;\n        else if (rest.startsWith(\"CHIL\")) currentRecord.children.push(refId);\n      }\n    }\n  });\n  finishRecord();\n  Object.values(familiesById).forEach((fam) => {\n    const father = fam.husb;\n    const mother = fam.wife;\n    fam.children.forEach((childId) => {\n      if (peopleById[childId]) {\n        peopleById[childId].parents = [];\n        if (father) peopleById[childId].parents.push(father);\n        if (mother) peopleById[childId].parents.push(mother);\n      }\n    });\n  });\n  return Object.values(peopleById);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}